name: Ping Website and Daily Report

on:
  schedule:
    - cron: '*/5 * * * *'  # Every 5 minutes
  workflow_dispatch:

jobs:
  ping:
    runs-on: ubuntu-latest
    steps:
    - name: Ping website and send daily message
      env:
        URL: https://telegramforwarder-5gl5.onrender.com
        TG_BOT_TOKEN: ${{ secrets.TG_BOT_TOKEN }}
        TG_CHAT_ID: ${{ secrets.TG_CHAT_ID }}
      run: |
        # Ping website
        curl -s -I --max-time 30 "$URL"
        echo "âœ… Website pinged successfully at $(date)"
        
        # Send daily message at 9 AM
        if [ $(date +%H) = "09" ] && [ $(date +%M) = "00" ]; then
          curl -s -X POST "https://api.telegram.org/bot$TG_BOT_TOKEN/sendMessage" \
            -d chat_id="$TG_CHAT_ID" \
            -d text="ðŸ¤– Daily Status: Your auto forwarder bot is working and live! ðŸŽ‰ Time: $(date)"
          echo "ðŸ“¨ Daily message sent"
        fi
